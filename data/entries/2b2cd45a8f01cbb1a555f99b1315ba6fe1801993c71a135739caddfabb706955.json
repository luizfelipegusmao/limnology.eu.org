{"title":"Trend Micro วิเคราะห์การโจมตี ForcedEntry ที่เจาะ iOS ได้โดยไม่ต้องคลิกใดๆ","link":"https://www.blognone.com/node/124770","date":1631709828000,"content":"<div><div><div><p>เมื่อวานนี้แอปเปิลปล่อยอัพเดตฉุกเฉิน iOS 14.8, watchOS 7.6.2, และ macOS 11.6 เพื่ออุดช่องโหว่หลายชุดของการโจมตี ForcedEntry ที่ Citizen Lab ระบุว่าเป็นช่องโหว่ที่ NSO Group ใช้วางมัลแวร์ Pegasus เพื่อติดตามเหยื่อ ตอนนี้ทาง Trend Micro ก็ออกมาวิเคราะห์มัลแวร์ตัวนี้</p>\n<p>ช่องโหว่ตัวนี้อาศัยบั๊กในตัวถอดรหัสการบีบอัดภาพ <a href=\"https://en.wikipedia.org/wiki/JBIG2\">JBIG2</a> ที่ฝังอยู่ใน PDF อีกทีหนึ่ง โดยฟังก์ชั่น <code>JBIG2Stream::readTextRegionSeg</code> ในเฟรมเวิร์ค CoreGraphics ที่มีบั๊ก Integer Overflow จากการประกาศตัวเป็นเป็นชนิด unsigned int ทำให้โค้ดจองหน่วยความจำน้อยกว่าที่ควรจะเป็น และกลายเป็นช่องโหว่ Heap Overflow ในที่สุด แอปเปิลแก้ช่องโหว่นี้โดยเพิ่มการตรวจสอบค่าเพิ่มเติม</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/5ef6e9261750da31685e50e44d9e8c7a.png\" /></p>\n<p>ตัวอย่างโค้ดที่แอปเปิลแก้ไขช่องโหว่แล้ว (ในกรอบแดง)</p>\n<p>จุดที่เป็นปริศนาคือแม้คนร้ายจะสามารถเจาะช่องโหว่ Heap Overflow ได้ แต่ crash log ที่ Citizen Lab นำมาแสดงกลับแสดงให้เห็นว่าระบบป้องกัน ASLR ที่จะสุ่มค่า address ของฟังก์ชั่นต่างๆ ในระบบนั้นกลับถูกปิดไป ทาง Trend Micro ระบุว่าหาก crash log เป็นข้อมูลที่ได้จากการโจมตีแสดงว่า Pegasus สามารถโจมตีเพื่อปิดการทำงาน ASLR ไปได้ก่อนแล้ว นอกจากนี้ยังพบว่า virtual function table ของออปเจกต์ถูกแก้ไขค่าระหว่างรัน แสดงให้เห็นว่าคนร้ายสามารถปิดการทำงานของฟีเจอร์ pointer authentication code (PAC) ไปได้ด้วย</p>\n<p>ตอนนี้ทาง Trend Micro สามารถวิเคราะห์จากโค้ดที่ Citizen Labเปิดเผยออกมาเท่านั้น และยังไม่สามารถหาตัวอย่างมัลแวร์ได้ด้วยตัวเอง แต่เมื่อมองเทคโนโลยีแล้วทำให้คาดได้ว่า Pegasus ใช้โจมตีอย่างเจาะจงเป้าหมายเป็นหลัก ไม่ได้เป็นการโจมตีเป็นวงกว้างแต่อย่างใดแต่ผู้ใช้ทุกคนก็ควรรีบอัพเดตเพื่อความปลอดภัย</p>\n<p>ที่มา - <a href=\"https://www.trendmicro.com/en_us/research/21/i/analyzing-pegasus-spywares-zero-click-iphone-exploit-forcedentry.html\">Trend Micro</a></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/ios\">iOS</a></div><div><a href=\"/topics/apple\">Apple</a></div><div><a href=\"/topics/security\">Security</a></div></div></div>","author":"lew","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"2b2cd45a8f01cbb1a555f99b1315ba6fe1801993c71a135739caddfabb706955","category":"Thai"}