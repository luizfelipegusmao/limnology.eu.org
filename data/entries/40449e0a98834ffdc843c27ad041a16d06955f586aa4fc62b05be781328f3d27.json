{"title":"[Arduino] สร้าง Custom Library เองใน PlatformIO แบบกากๆ","link":"https://thanapon.info/arduino-platformio-lib/","date":1609340487000,"content":"<p>สวัสดีครับ หลังจากที่ไม่ได้เขียน blog มาประมาณ 2 เดือน พอดีได้ลองไปศึกษาสไตล์การเขียนโปรแกรมมานิดหน่อย ก็เลยอยากจะมาแชร์วิธีการทำ custom library ใน PlatformIO เพื่อให้ project ของเรามีความเป็นระเบียบเรียบร้อยและสวยหรู</p>\n\n\n\n<hr />\n\n\n\n<h3>โม้ PlatformIO หน่อย</h3>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2020/12/image.png\" /></figure><div>\n<p>สำหรับท่านใดที่ไม่เคยใช้ PlatformIO หรือยังไม่รู้ว่าคืออะไรไม่ต้องตกใจจะครับ ตัว PlatformIO จริงๆเป็นแค่ extension ตัวหนึ่งใน Visual studio วิธีติดตั้งก็ง่ายมากครับแค่ไปค้นหา extension ใน Visual studio เอ๊งงง…..</p>\n</div></div>\n\n\n\n<p>ส่วน PlatformIO เป็น extension แต่ไม่ได้เป็น extension กระจอกๆ โดยตัวของมันเองเป็น tools สำหรับให้พวก developer สามารถพัฒนา embedded system ไม่ว่าจะเป็น coding, compile และ upload binary file ไปยังอุปกรณ์ ที่เราใช้ได้ </p>\n\n\n\n<p>ถ้าเราไปดูใน <a href=\"https://platformio.org/\" target=\"_blank\">document</a> ของเขาก็จะเห็นว่า PlatformIO สามารถรองรับ</p>\n\n\n\n<ul><li>932 Board ไม่ว่าจะเป็นบอร์ดตระกูล AVR, ARM, ESP</li><li>10690 Library ที่จำเป็นๆ มีหมดเช่น Adafruit และต่างๆ</li></ul>\n\n\n\n<p>ซึ่งถือว่าพร้อมใช้งานมากครับ ถ้าเทียบกับ ArduinoIDE เพราะเราจำเป็นต้องลง library เยอะแยะ ถ้าหากว่าเราย้ายที่ทำงานบ่อยๆ แต่ปัญหาจะหมดไปเมื่อใช้ PlatformIO เราก็แค่กำหนด <a href=\"https://docs.platformio.org/en/latest/projectconf/section_env_library.html#lib-deps\" target=\"_blank\">lib_deps </a>[Library dependencies] ใน platformio.ini แล้วจากนั้นก็จะสามารถใช้งานได้อย่างไม่ต้องกังวลเรื่องการย้ายเครื่องบ่อยๆ เพราะ PlatformIO จะทำการ sync library เองอัตโนมัติ</p>\n\n\n\n<p>อีกทั้ง Visual studio code นั้นจะมี Git version control เพิ่มเข้ามาทำให้สะดวกใช้งานและเทียบการเปลี่ยนแปลงของโค๊ดเราได้และไม่ต้องกลัวโค๊ดหายอีกต่อไปครับ</p>\n\n\n\n<h3>เริ่มสร้าง Library ของเราดีกว่า</h3>\n\n\n\n<p>เบื้องต้นหลังจากที่เราทำการสร้าง Project จาก PlatformIO แล้ว Project structure จะได้เป็น</p>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2020/12/image-1.png\" /><figcaption>Project structure</figcaption></figure></div>\n\n\n\n<p>เริ่มต้นเราจะต้องเข้าไปสร้าง Library ของเราใน [lib] โดยผมจะตั้งชื่อ folder ว่า calculator  หลังจากนั้นทำการสร้างไฟล์ .cpp และ .h ขึ้นมา</p>\n\n\n\n<figure><img src=\"https://thanapon.info/wp-content/uploads/2020/12/image-4.png\" /></figure>\n\n\n\n<p>โดยภายในไฟล์ calculator.h นั้นเราจะทำการเพิ่มในส่วนของ header และจะสร้าง class ในส่วนของ content นะครับ ซึ่ง Class ของเครื่องคิดเลขที่ผมสร้างก็จะมี method แค่ บวก กับลบแค่นั้นนะครับ ตามสไตล์ library กากๆ</p>\n\n\n\n<div><pre><code>#ifndef CALCULATOR_H\n#define CALCULATOR_H\n#include &lt;Arduino.h&gt;\nclass Calculator\n{\npublic:\n    Calculator() {}\n    int add(int a, int b);\n    int minus(int a, int b);\n};\n#endif</code></pre></div>\n\n\n\n<p>หลังจากเราสร้างไฟล์ header สำหรับให้ไฟล์ main เรียกใช้แล้ว ต่อมาให้เราสร้างไฟล์ source code ของ class ที่เราประกาศไปก่อนหน้านี้ครับ</p>\n\n\n\n<div><pre><code>#include &lt;calculator.h&gt;\nint Calculator ::add(int a, int b)\n{\n    return a + b;\n}\nint Calculator ::minus(int a, int b)\n{\n    return a - b;\n}</code></pre></div>\n\n\n\n<p>สำหรับการสร้าง library เครื่องคิดเลขสไตล์กากๆ ก็เสร็จแล้วครับส่วนการใช้งานเราก็ต้องกลับมายังไฟล์ main.cpp ซึ่งจะอยู่ใน src/main.cpp โดยจะต้อง include header ของ library เราเข้ามาในไฟล์ main ก่อน แล้วหลังจากนั้น declare class ของ Calculator ซึ่งเราจะสามารถเรียกใช้ method Add กับ Minus ได้นะครับ</p>\n\n\n\n<div><pre><code>#include &lt;Arduino.h&gt;\n#include &lt;calculator.h&gt;\n\nCalculator calculator;\n\nvoid setup()\n{\n  // put your setup code here, to run once:\n  calculator.add(1, 2);\n  calculator.minus(2, 1);\n}\n\nvoid loop()\n{\n  // put your main code here, to run repeatedly:\n}</code></pre></div>\n\n\n\n<p>จากนั้นทดสอบ build โปรเจคดูนะครับ ถ้าไม่มี error แสดงว่าผ่านครับโผมมม</p>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2020/12/image-5-1024x275.png\" /></figure></div>\n\n\n\n<p>เป็นอันว่าจบการสร้าง custom library ฉบับสไตล์กากๆของผมนะครับ สำหรับวันนี้ขอบคุณและสวัสดีปีใหม่ 2021 ครับผม <img src=\"https://s.w.org/images/core/emoji/13.0.0/72x72/1f609.png\" /></p>\n\n\n\n<hr />\n\n\n\n<blockquote><p><a href=\"https://platformio.org/\" target=\"_blank\">PlatformIO is a cross-platform, cross-architecture, multiple framework, professional tool for….</a></p><cite>https://platformio.org/</cite></blockquote>\n\n\n\n<blockquote><p><a href=\"https://github.com/toygame/platformio-example.git\" target=\"_blank\">PlatformIO Project Structure: Github</a></p><cite>https://github.com/toygame/platformio-example.git</cite></blockquote>\n\n\n\n<p></p>\n<p>The post <a href=\"https://thanapon.info/arduino-platformio-lib/\">[Arduino] สร้าง Custom Library เองใน PlatformIO แบบกากๆ</a> appeared first on <a href=\"https://thanapon.info\">Thanapon</a>.</p>","author":"thanapon.tap","siteTitle":"Thanapon","siteHash":"6a039c2f54d76e4c49227d80968f2a30de5427cc57525c047c383ea3563cde5f","entryHash":"40449e0a98834ffdc843c27ad041a16d06955f586aa4fc62b05be781328f3d27","category":"Thai"}