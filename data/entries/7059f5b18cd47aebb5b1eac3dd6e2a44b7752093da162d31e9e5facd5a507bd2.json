{"title":"Amazon Detective adds new capabilities to accelerate and improve your cloud security investigations","link":"https://aws.amazon.com/blogs/aws/amazon-detective-adds-investigations-and-finding-group-summaries-to-help-you-investigate-security-findings/","date":1701051187000,"content":"<p>Today, <a href=\"https://aws.amazon.com/detective\">Amazon Detective</a> adds four new capabilities to help you save time and strengthen your security operations.</p> \n<p>First, <strong>Detective investigations for IAM</strong> help security analysts investigate <a href=\"https://aws.amazon.com/iam/\">AWS Identity and Access Management (IAM)</a> objects, such as users and roles, for <a href=\"https://en.wikipedia.org/wiki/Indicator_of_compromise\">indicators of compromise</a> (IoCs) to determine potential involvement in known tactics from the <a href=\"https://attack.mitre.org/\">MITRE ATT&amp;CK framework</a>. These automatic investigations are available in the Detective section of the <a href=\"https://console.aws.amazon.com\">AWS Management Console</a> and through a new API to automate your analysis or incident response or to send these findings to other systems, such as <a href=\"https://aws.amazon.com/security-hub/\">AWS Security Hub</a> or your <a href=\"https://en.wikipedia.org/wiki/Security_information_and_event_management\">SIEM</a>.</p> \n<p>Second, <strong>Detective finding group summaries</strong> uses generative artificial intelligence (AI) to enrich its investigations. It automatically analyzes finding groups and provides insights in natural language to accelerate security investigations. It provides a plain language title based on the analysis of the finding group with relevant summarized insights, such as describing the activity that initiated the event and its impact, if any. Finding group summaries handles the heavy lifting of analyzing the finding group built across multiple AWS data sources, making it easier and faster to investigate unusual or suspicious activity.</p> \n<p>In addition to these two new capabilities that I describe in this post, Detective adds another two capabilities not covered here:</p> \n<ul> \n <li><a href=\"https://aws.amazon.com/about-aws/whats-new/2023/11/amazon-detective-security-guardduty-ecs-monitoring/\">Detective now supports security investigations for threats detected by Amazon GuardDuty ECS Runtime Monitoring</a>.</li> \n <li><a href=\"https://aws.amazon.com/about-aws/whats-new/2023/11/amazon-detective-log-retrieval-security-lake/\">Detective now integrates with Amazon Security Lake</a>, enabling security analysts to query and retrieve logs stored in Security Lake.</li> \n</ul> \n<p><a href=\"https://aws.amazon.com/detective\">Amazon Detective</a> makes it easier to analyze, investigate, and quickly identify the root cause of security findings or suspicious activities. Detective uses machine learning (ML), statistical analysis, and graph theory to help you visualize and conduct faster and more efficient security investigations. Detective automatically collects logs data and events from sources like <a href=\"https://aws.amazon.com/cloudtrail/\">AWS CloudTrail</a> logs, <a href=\"https://aws.amazon.com/vpc/\">Amazon Virtual Private Cloud (Amazon VPC)</a> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html\">Flow Logs</a>, <a href=\"https://aws.amazon.com/guardduty/\">Amazon GuardDuty</a> findings, <a href=\"https://aws.amazon.com/eks/\">Amazon Elastic Kubernetes Service (Amazon EKS)</a> audit logs, and AWS security findings. Detective maintains up to a year of aggregated data for analysis and investigations.</p> \n<p>Cloud security professionals often find threat hunting and incident investigations to be resource-intensive and time-consuming. They must manually gather and analyze data from various sources to identify potential IAM-related threats. IAM investigations are particularly challenging due to dynamic cloud permissions and credentials. Analysts need to piece together data from different systems, including audit logs, entitlement reports, and CloudTrail events, which can be dispersed. Cloud permissions are often granted on-demand or through automation scripts, making authorization changes hard to track. Reconstructing activity timelines and identifying irregular entitlements can take hours or days, depending on complexity. Limited visibility into legacy systems and incomplete logs further complicates IAM investigations, making it difficult to obtain a definitive understanding of unauthorized access.</p> \n<p>Detective investigations for IAM triage findings and surface only the most critical, suspicious issues, allowing security analysts to focus on high-level investigations. It automatically analyzes resources in your AWS environment to identify potential indicators of compromise or suspicious activity using machine learning and threat intelligence. This allows analysts to identify patterns and comprehend which resources are impacted by security events, offering a proactive approach to threat identification and mitigation.</p> \n<p>The investigations are not only available in the console; you can use the new <code>StartInvestigation</code> API to automate a remediation workflow or collect information about all IP involved or AWS resources compromised. You can also use the API to feed the data to other systems to build a consolidated view of your security posture.</p> \n<p>Finding group summaries evaluates the connections between security events across an environment and provides insights in natural language that link related threats, compromised resources, and malicious actor behavior. This narrative offers security analysts a comprehensive overview of security incidents that goes beyond individual service reports. By grouping and contextualizing data from multiple sources, finding group summaries identifies threats that might go unnoticed when insights are isolated. This approach improve the speed and efficiency of investigations and responses. Security analysts can utilize finding group summaries to gain a holistic understanding of security events and their interrelationships, helping them make informed decisions regarding containment and remediation.</p> \n<p><span><strong>Let’s see these two capabilities in action<br /> </strong></span>In this demo, I start with Detective investigations for IAM in <a href=\"https://console.aws.amazon.com/detective/\">the Detective section of the console</a>. The Detective dashboard shows me the number of investigations done and the number of IAM roles and users involved in suspicious activities.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-41-49.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-41-49.png\" alt=\"Detective Automated Investifation - dashboard\" width=\"800\" height=\"443\" /></a></p> \n<p>From there, I drill down the list of investigations.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-38-46.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-38-46.png\" alt=\"Detective Automated Investifation - list\" width=\"800\" height=\"455\" /></a></p> \n<p>And I select one specific investigation to get the details. There is a summary first.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-39-40.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-39-40.png\" alt=\"Detective Automated Investifation - dashb\" width=\"800\" height=\"231\" /></a></p> \n<p>I scroll down the page to see what IP addresses are involved and for what type of activities. This example shows me a physical impossibility: the same IP was used in a short time from two different places, Australia and Japan.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-40-38.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-40-38.png\" alt=\"Detective Automated Investifation - ip addresses\" width=\"800\" height=\"379\" /></a></p> \n<p>The most interesting section of the page, in my opinion, is the mappings to <a href=\"https://csrc.nist.gov/glossary/term/Tactics_Techniques_and_Procedures\">tactics, techniques, and procedures</a> (TTP). All TTPs are classified according to their severity. The console shows the techniques and actions used. When selecting a specific TTP, I can see the details in the right pane. In this example, the suspicious IP address has been involved in more than 2,000 failed attempts to change the trusted policy of an IAM role.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-41-18.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-41-18.png\" alt=\"Detective Automated Investifation - ttps\" width=\"800\" height=\"510\" /></a></p> \n<p>Finally, I navigate to the <strong>Indicators</strong> tab to see the list of indicators.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-41-37.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/10/27/2023-10-27_12-41-37.png\" alt=\"Detective Automated Investifation - indicators\" width=\"800\" height=\"476\" /></a></p> \n<p>On the other side, finding group summaries is available under <strong>Finding groups</strong>. I select a finding group to receive a natural language explanation of the findings and risks involved.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/11/15/Screenshot-2023-11-15-at-1.40-PM.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/11/15/Screenshot-2023-11-15-at-1.40-PM.png\" alt=\"Detective Gen AI Findings\" width=\"800\" height=\"515\" /></a></p> \n<p><span><strong>Pricing and availability<br /> </strong></span>These two new capabilities are now available to all AWS customers.</p> \n<p>Detective investigations for IAM is available in all AWS Regions <a href=\"https://docs.aws.amazon.com/general/latest/gr/detective.html\">where Detective is available</a>. Finding group summaries is available in five AWS Regions: US East (N. Virginia), US West (Oregon), Asia Pacific (Singapore, Tokyo), and Europe (Frankfurt).</p> \n<p>Learn all <a href=\"https://aws.amazon.com/detective/\">the details about Amazon Detective and get started today</a>.</p> \n<a href=\"https://twitter.com/sebsto\">-- seb</a>","author":"Sébastien Stormacq","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"7059f5b18cd47aebb5b1eac3dd6e2a44b7752093da162d31e9e5facd5a507bd2","category":"Tech"}