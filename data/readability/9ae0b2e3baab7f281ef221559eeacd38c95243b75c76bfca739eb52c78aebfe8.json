{"title":"Introducing AWS Systems Manager Change Manager","link":"https://aws.amazon.com/blogs/aws/introducing-systems-manager-change-manager/","date":1608050120000,"content":"<div id=\"readability-page-1\" class=\"page\"><section property=\"articleBody\"><div id=\"amazon-polly-audio-tab\"><p><a href=\"https://aws.amazon.com/polly/\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://a0.awsstatic.com/aws-blog/images/Voiced_by_Amazon_Polly_EN.png\" width=\"554\" height=\"56\"></a></p></div><p>Because you are constantly listening to the feedback from your customer, you are iterating, innovating, and improving your applications and infrastructures. You continually modify your IT systems in the cloud. And let’s face it, changing something in a working system risks breaking things or introducing side effects that are sometimes unpredictable; it doesn’t matter how many tests you do. On the other hand, not making changes is stasis, followed by irrelevance, followed by death.</p><p>This is why organizations of all sizes and types have embraced a culture of controlling changes. Some organizations adopt change management processes such as <a href=\"https://en.wikipedia.org/wiki/Change_management_(ITSM)\">the ones defined in ITIL v4</a>. Some have adopted DevOps’ <a href=\"https://en.wikipedia.org/wiki/Continuous_deployment\">Continuous Deployment</a>, or other methods. In any case, to support your change management processes, it is important to have tools.</p><p>Today, we are launching <a href=\"https://aws.amazon.com/systems-manager/\" title=\"AWS Systems Manager Change Manager\">AWS Systems Manager Change Manager</a>, a new change management capability for <a href=\"https://aws.amazon.com/systems-manager/\" title=\"\">AWS Systems Manager</a>. It simplifies the way ops engineers track, approve, and implement operational changes to their application configurations and infrastructures.</p><p>Using <span title=\"\">Change Manager</span> has two primary advantages. First, it can improve the safety of changes made to application configurations and infrastructures, reducing the risk of service disruptions. It makes operational changes safer by tracking that only approved changes are being implemented. Secondly, it is tightly integrated with other AWS services, such as <a href=\"https://aws.amazon.com/organizations/\" title=\"\">AWS Organizations</a> and <a href=\"https://aws.amazon.com/single-sign-on/\" title=\"AWS Single Sign-On\">AWS Single Sign-On</a>, or the integration with the <a href=\"https://aws.amazon.com/systems-manager/\" title=\"\">Systems Manager</a> change calendar and <a href=\"https://aws.amazon.com/cloudwatch/\" title=\"\">Amazon CloudWatch</a> alarms.</p><p><span title=\"\">Change Manager</span> provides accountability with a consistent way to report and audit changes made across your organization, their intent, and who approved and implemented them.</p><p><span title=\"\">Change Manager</span> works across AWS Regions and multiple AWS accounts. It works closely with <a href=\"https://aws.amazon.com/organizations/\" title=\"\">Organizations</a> and <span title=\"\">AWS SSO</span> to manage changes from a central point and to deploy them in a controlled way across your global infrastructure.</p><p><span><strong>Terminology</strong></span><br>You can use <span title=\"\">AWS Systems Manager Change Manager</span> on a single AWS account, but most of the time, you will use it in a multi-account configuration.</p><p>The way you manage changes across multiple AWS accounts depends on how these accounts are linked together. <span title=\"\">Change Manager</span> uses the relationships between your accounts defined in <a href=\"https://aws.amazon.com/organizations/\" title=\"\">AWS Organizations</a>. When using <span title=\"\">Change Manager</span>, there are three types of accounts:</p><ul><li><strong>The management account</strong> – also known as the “main account” or “root account.” The management account is the root account in an <span title=\"\">AWS Organizations</span> hierarchy. It is the management account by virtue of this fact.</li><li><strong>The delegated administrator account</strong> – A delegated administrator account is an account that has been granted permission to manage other accounts in <a href=\"https://aws.amazon.com/organizations/\" title=\"\">Organizations</a>. In the <span title=\"\">Change Manager</span> context, this is the account from which change requests will be initiated. You will typically log in to this account to manage templates and change requests. Using a delegated administrators account allows you to limit connections made to the root account. It also allows you to enforce a least privileges policy by using a specific subset of permissions required by the changes.</li><li><strong>The member accounts</strong> – Member accounts are accounts that are not the management account or a delegated administrator account, but are still included in <a href=\"https://aws.amazon.com/organizations/\" title=\"\">Organizations</a>. In my mental model for <span title=\"\">Change Manager</span>, these would be the accounts that hold the resources where changes are deployed. A delegated administrator account would initiate a change request that would impact resources in a member account. System administrators are discouraged from logging directly into these accounts.</li></ul><p>Let’s see how you can use <a href=\"https://aws.amazon.com/systems-manager/\" title=\"AWS Systems Manager Change Manager\">AWS Systems Manager Change Manager</a> by taking a short walk-through demo.</p><p><span><strong>One-Time Configuration<br></strong></span>In this scenario, I show you how to use <span title=\"\">Change Manager</span> with multiple AWS accounts linked together with <a href=\"https://aws.amazon.com/organizations/\" title=\"\">Organizations</a>. If you are not interested in the one-time configuration, jump to the <strong>Create a Change Request</strong> section below.</p><p>There are four one-time configuration actions to take before using <span title=\"\">Change Manager</span>: one action in the root account and three in the delegated administrator account. In the root account, I use <strong>Quick Setup</strong> to define my delegated administrator account and initially configure permissions on the accounts. In the delegated administrator account, you define your source of user identities, you define what users have permissions to approve change templates, and you define a change request template.</p><p>First, I ensure I have an Organization in place and my AWS accounts are organized in Organizational Units (OU). For the purpose of this simple example, I have three accounts: the root account, the delegated administrator account in the management OU and a member account in the managed OU. When ready, I use Quick Setup on the root account to configure my accounts. There are multiple paths leading to Quick Setup; for this demo, I use the blue banner on top of the Quick Setup console, and I click <strong>Setup Change Manager</strong>.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_08-27-05.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_08-27-05.png\" alt=\"Change Manager Quick Setup\" width=\"2420\" height=\"1080\"></a></p><p>On the Quick Setup page, I enter the ID of the delegated administrator account if I haven’t defined it already. Then I choose the permissions boundaries I grant to the delegated administrator account to perform changes on my behalf. This is the maximum permissions <span title=\"\">Change Manager</span> receives to make changes. I will further restrict this permission set when I create change requests in a few minutes. In this example, I grant <span title=\"\">Change Manager</span> permissions to call any <code>ec2</code> API. This effectively authorizes <span title=\"\">Change Manager</span> to only run changes related to EC2 instances.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_08-29-51.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_08-29-51.png\" alt=\"Change Manager Quick Setup\" width=\"1734\" height=\"1416\"></a></p><p>Lower on the screen, I choose the set of accounts that are targets for my changes. I choose between <strong>Entire organization</strong> or <strong>Custom</strong> to select one or multiple OUs.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_08-30-21.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_08-30-21.png\" alt=\"Change Manager Quick Setup 2 \" width=\"1692\" height=\"1210\"></a></p><p>After a while, Quick Setup finishes configuring my AWS accounts permission and I can move to the second part of the one-time setup.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_12-40-22.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_12-40-22.png\" alt=\"Change Manager Quick Setup 3\" width=\"3188\" height=\"894\"></a></p><p>Second, I switch to my delegated administrator account. <span title=\"\">Change Manager</span> asks me how I manage users in my organization: with <a href=\"https://aws.amazon.com/iam/\" title=\"\">AWS Identity and Access Management (IAM)</a> or <a href=\"https://aws.amazon.com/single-sign-on/\" title=\"AWS Single Sign-On\">AWS Single Sign-On</a>? This defines where <span title=\"\">Change Manager</span> pulls user identities when I choose approvers. This is a one-time configuration option. This can be changed at any time in the <span title=\"\">Change Manager</span> <strong>Settings</strong> page.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_09-50-51.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_09-50-51.png\" alt=\"Change Manager Settings\" width=\"684\" height=\"427\"></a></p><p>Third, on the same page, I define an <a href=\"https://aws.amazon.com/sns/\" title=\"\">Amazon Simple Notification Service (SNS)</a> topic to receive notifications about template reviews. This channel is notified any time a template is created or modified, to let template approvers review and approve templates. I also define the IAM (or SSO) user with permission to approve change templates (more about these in one minute).</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_09-59-20.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_09-59-20.png\" alt=\"Change Manager Template Reviewers\" width=\"1008\" height=\"706\"></a></p><p>Optionally, you can use the existing <a href=\"https://aws.amazon.com/systems-manager/\" title=\"\">AWS Systems Manager</a> Change Calendar <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-change-calendar.html\">to define the periods</a>&nbsp;where changes are not authorized, such as marketing events or holiday sales.</p><p>Finally, I define a change template. Every change request is created from a template. Templates define common parameters for all change requests based on them, such as the change request approvers, the actions to perform, or the <span title=\"\">SNS</span> topic to send notifications of progress. You can enforce the review and approval of templates before they can be used. It makes sense to create multiple templates to handle different type of changes. For example, you can create one template for standard changes, and one for emergency changes that overrides the change calendar. Or you can create different templates for different types of <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-automation.html\">automation run books</a> (documents).</p><p>To help you to get started, we created a template for you: the “Hello World” template. You can use it as a starting point to create a change request and test out your approval flow.</p><p>At any time, I can create my own template. Let’s imagine my system administrator team is frequently restarting <a href=\"https://aws.amazon.com/ec2/\" title=\"\">EC2</a> instances. I create a template allowing them to create change requests to restart one or multiple instances. Using the delegated administrator account, I navigate to the <span title=\"\">Change Manager</span> management <a href=\"https://console.us-east-1.console.aws.amazon.com/systems-manager/change-manager/home#\">console</a> and click <strong>Create template</strong>.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_10-37-08.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_10-37-08.png\" alt=\"Change Manager Create Template\" width=\"758\" height=\"192\"></a></p><p>In a nutshell, a template defines the list of authorized actions, where to send notifications and who can approve the change request. Actions are an <span title=\"AWS Systems Manager\">AWS Systems Manager</span> <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/runbook-scripts.html\">runbook</a>. <strong>Emergency change templates</strong> allow change requests to bypass the change calendar I wrote about earlier. Under <strong>Runbook Options</strong>, I choose one or multiple <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/runbook-scripts.html\">runbooks</a> allowed to run. For this example, I choose the <code>AWS EC2RestartInstance</code> runbook.</p><p>I use the console to create the template, but templates are defined internally as YAML. I can edit the YAML using the <strong>Editor</strong> tab, or when I am using the <a href=\"https://aws.amazon.com/cli/\" title=\"\">AWS Command Line Interface (CLI)</a> or API. This means I can version control them just like the rest of my infrastructure (as code).<a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_10-50-34.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_10-50-34.png\" alt=\"Change Manager Create Template part 1\" width=\"993\" height=\"803\"></a></p><p>Just below, I document my template using text formatted as markdown format. I use this section to document the defining characteristics of the template and provide any necessary instructions, such as back-out procedures, to the requestor.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_12-54-09.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_12-54-09.png\" alt=\"Change Manager Template Documentation\" width=\"2202\" height=\"660\"></a></p><p>I scroll down that page and click <strong>Add Approver</strong> to define approvers. Approvers can be individual users or groups. The list of approvers are defined either at the template level or in the change request itself. I also choose to create an <span title=\"\">SNS</span> topic to inform approvers when any requests are created that require their approval.</p><p>In the <strong>Monitoring</strong> section I select the alarm that, when active, stops any change based on this template, and initiate a rollback.</p><p>In the <strong>Notifications</strong> section, I select or create another <span title=\"\">SNS</span> topic so I’m notified when status changes for this template occur.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-11-30_10-53-51.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-11-30_10-53-51.png\" alt=\"Change Manager Create Template part 2\" width=\"1100\" height=\"834\"></a></p><p>Once I am done, I save the template and submit it for review.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-24-57-1.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-24-57-1.png\" alt=\"Change Manager Submit Template for Review\" width=\"1578\" height=\"464\"></a></p><p>Templates have to be reviewed and approved before they can be used. To approve the template, I connect the console as the <code>template_approver</code> user I defined earlier. As <code>template_approver</code> user, I see pending approvals on the <strong>Overview</strong> tab. Or, I navigate to the <strong>Templates</strong> tab, select the template I want to review. When I am done reviewing it, I click <strong>Approve</strong>.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-26-58.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-26-58.png\" alt=\"Change Manager Approve Template\" width=\"984\" height=\"534\"></a></p><p>Voila, now we’re ready to create change requests based on this template. Remember that all the preceding steps are one-time configurations and can be amended at any time. When existing templates are modified, the changes go through a review and approval process again.</p><p><span><strong>Create a Change Request<br></strong></span>To create a change request on any account linked to the Organization, I open a <span title=\"\">AWS Systems Manager Change Manager</span> <a href=\"https://console.aws.amazon.com/systems-manager/change-manager/home#?region=us-east-1\">console</a> from the delegated administrator account and click <strong>Create request</strong>.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-48-37.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-48-37.png\" alt=\"Change Manager Create Request\" width=\"1143\" height=\"196\"></a></p><p>I choose the template I want to use and click <strong>Next</strong>.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-50-42.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-50-42.png\" alt=\"Change Manager Select Template\" width=\"1170\" height=\"618\"></a>I enter a name for this change request. The change is initiated immediately after all approvals are granted, or I specify an optional scheduled time. When the template allows me, I choose the approver for this change. In this example, the approver is defined by the template and cannot be changed. I click <strong>Next</strong>.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-53-00.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_11-53-00.png\" alt=\"Change Manager Create CR part 1\" width=\"852\" height=\"824\"></a></p><p>On the next screen, there are multiple important configuration options, relating to the actual execution of the change:</p><ul><li><strong>Target location</strong> – lets me define on which target AWS accounts and AWS Region I want to run this change.</li><li><strong>Deployment target</strong> – lets me define which resources are the target of this change. One EC2 instance? Or multiple ones identified by their tags, their resources groups, a list of instance IDs, or all EC2 instances.</li><li><strong>Runbook parameters</strong> – lets me define the parameters I want to pass to my runbook, if any.</li><li><strong>Execution role</strong> – lets me define the set of permissions I grant the System Manager to deploy with this change. The permission set must have service <code>ssm.amazonaws.com</code> as principal for the <a href=\"https://docs.amazonaws.cn/en_us/IAM/latest/UserGuide/access_policies.html\">trust policy</a>. Selecting a role allows me to grant the <span title=\"\">Change Manager</span> runtime a different permission set than the one I have.</li></ul><p>Here is an example allowing <span title=\"\">Change Manager</span> to stop an EC2 instance (you can scope it down to a specific AWS account, specific Region, or specific instances):</p><p>And the associated trust policy:</p><p>When I am ready, I click <strong>Next</strong>. On the last page, I review my data entry and click <strong>Submit for approval</strong>.</p><p>At this stage, the approver receives a notification, based on the <span title=\"\">SNS</span> topic configured in the template. To continue this demo, I sign out of the console and sign in again as the <code>cr_approver</code> user, which I created, with permission to view and approve change requests.</p><p>As the <code>cr_approver</code> user, I navigate to the <a href=\"https://console.aws.amazon.com/systems-manager/change-manager/home#/change-request/\">console</a>, review the change request, and click <strong>Approve</strong>.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_14-02-59.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/11/30/2020-11-30_14-02-59.png\" alt=\"Change Manager Review Change Request\" width=\"972\" height=\"483\"></a></p><p>The change request status switches to scheduled, and eventually turns green to <strong>Success</strong>. At any time, I can click the change request to get the status, and to collect errors, if any.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_13-36-26.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_13-36-26.png\" alt=\"Change Manager Dashboard with Succeeded Request\" width=\"2658\" height=\"586\"></a></p><p>I click on the change request to see the details. In particular, the <strong>Timeline</strong> tab shows the history of this CR.</p><p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_13-28-53.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2020/12/13/2020-12-13_13-28-53.png\" alt=\"Change Management CR Timeline\" width=\"2706\" height=\"1156\"></a></p><p><span><strong>Availability and Pricing<br></strong></span><a href=\"https://aws.amazon.com/systems-manager/\" title=\"AWS Systems Manager Change Manager\">AWS Systems Manager Change Manager</a> is available today in all commercial AWS Regions, except mainland China. The pricing is based on two dimensions: the number of change requests you submit and the total number of API calls made. The number of change requests you submit will be the main cost factor. We will charge $0.29 per change request. Check <a href=\"https://aws.amazon.com/systems-manager/pricing/\">the pricing page</a> for more details.</p><p>You can evaluate <span title=\"\">Change Manager</span> for free for 30 days, starting on your first change request.</p><p>As usual, let us know <a href=\"https://forums.aws.amazon.com/forum.jspa?forumID=185\">what you think</a> and <a href=\"https://console.aws.amazon.com/systems-manager/change-manager/home#/\"><strong>let’s get started today</strong></a></p><a href=\"https://twitter.com/sebsto\" title=\"Seb on Twitter\">-- seb</a></section></div>","author":"Sébastien Stormacq","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"9ae0b2e3baab7f281ef221559eeacd38c95243b75c76bfca739eb52c78aebfe8","category":"Tech"}